(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,79474,(e,t,r)=>{"use strict";var o=e.r(71645).__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;r.c=function(e){return o.H.useMemoCache(e)}},932,(e,t,r)=>{"use strict";t.exports=e.r(79474)},30257,e=>{"use strict";var t=e.i(43476),r=e.i(71645);e.i(47167);var o=e.i(86909);let s=async(e,t={})=>{if(!(0,o.isAuthenticated)())throw console.error("User is not authenticated"),Error("User is not authenticated");let r=(0,o.getToken)();if(!r)throw console.error("No token found"),Error("No authentication token found");let s=`http://localhost:8000${e}`,a={"Content-Type":"application/json",Authorization:`Bearer ${r}`,...t.headers};console.log("Making API request:",{url:s,headers:{"Content-Type":a["Content-Type"],Authorization:a.Authorization?"Bearer [TOKEN]":"Missing"}});let n=await fetch(s,{...t,headers:a});if(!n.ok){let e=await n.json().catch(()=>({}));throw console.error("API request failed:",e),Error(e.detail||`HTTP error! status: ${n.status}`)}return 204===n.status?null:n.json()},a=async e=>{try{if(!e)throw Error("User ID is required to fetch tasks");return await s(`/api/${e}/tasks`)}catch(e){throw console.error("Error fetching tasks:",e),e}},n=async(e,t)=>{try{if(!e)throw Error("User ID is required to create a task");return await s(`/api/${e}/tasks`,{method:"POST",body:JSON.stringify(t)})}catch(e){throw console.error("Error creating task:",e),e}},l=async(e,t,r)=>{try{if(!e)throw Error("User ID is required to update a task");return await s(`/api/${e}/tasks/${t}`,{method:"PUT",body:JSON.stringify(r)})}catch(e){throw console.error("Error updating task:",e),e}},c=async(e,t)=>{try{if(!e)throw Error("User ID is required to delete a task");await s(`/api/${e}/tasks/${t}`,{method:"DELETE"})}catch(e){throw console.error("Error deleting task:",e),e}},i=async(e,t,r)=>{try{if(!e)throw Error("User ID is required to toggle task completion");return await s(`/api/${e}/tasks/${t}/complete`,{method:"PATCH"})}catch(e){throw console.error("Error toggling task completion:",e),e}},d=async e=>{try{if(!e)throw Error("User ID is required to fetch pending tasks count");return await s(`/api/${e}/pending-tasks`)}catch(e){throw console.error("Error fetching pending tasks count:",e),e}},u=async e=>{try{if(!e)throw Error("User ID is required to fetch completed tasks count");return await s(`/api/${e}/completed-tasks`)}catch(e){throw console.error("Error fetching completed tasks count:",e),e}},h=({tasks:e,forceShowAddForm:s=!1,onAddTaskClick:a,onTaskAdded:d,onTaskUpdated:u,onTaskDeleted:h})=>{let[m,x]=(0,r.useState)(e),[b,p]=(0,r.useState)(null),[g,f]=(0,r.useState)(!1),[w,k]=(0,r.useState)(""),[y,N]=(0,r.useState)(""),[j,v]=(0,r.useState)(!1),[T,E]=(0,r.useState)(null),[S,_]=(0,r.useState)(""),[C,A]=(0,r.useState)(""),U=(0,o.getToken)();if(U)try{let e=JSON.parse(atob(U.split(".")[1]));e.userId||e.sub||console.error("User ID not found in token payload")}catch(e){console.error("Error parsing token:",e)}(0,r.useEffect)(()=>{x(e)},[e]),(0,r.useEffect)(()=>{s&&(f(!0),a&&a())},[s,a]);let I=e=>({id:e.id.toString(),title:e.title,description:e.description,completed:e.completed,userId:e.user_id,createdAt:e.created_at,updatedAt:e.updated_at,completedAt:null}),D=async(e,t)=>{if(b===e)return;let r=(0,o.getToken)(),s="";if(r)try{let e=JSON.parse(atob(r.split(".")[1]));if(!(s=e.userId||e.sub||""))return void console.error("User ID not found in token payload")}catch(e){console.error("Error parsing token:",e);return}p(e);try{let r=await i(s,e,!t),o=I(r);x(t=>t.map(t=>t.id===e?o:t)),u&&u(o)}catch(e){console.error("Error toggling task:",e)}finally{p(null)}},O=async e=>{if(b===e)return;let t=(0,o.getToken)(),r="";if(t)try{let e=JSON.parse(atob(t.split(".")[1]));if(!(r=e.userId||e.sub||""))return void console.error("User ID not found in token payload")}catch(e){console.error("Error parsing token:",e);return}p(e);try{await c(r,e),x(t=>t.filter(t=>t.id!==e)),h&&h(e)}catch(e){console.error("Error deleting task:",e)}finally{p(null)}},$=async e=>{if(e.preventDefault(),!w.trim()||j)return;let t=(0,o.getToken)(),r="";if(t)try{let e=JSON.parse(atob(t.split(".")[1]));if(!(r=e.userId||e.sub||""))return void console.error("User ID not found in token payload")}catch(e){console.error("Error parsing token:",e);return}v(!0);try{let e=await n(r,{title:w,description:y}),t=I(e);x(e=>[t,...e]),d&&d(t),k(""),N(""),f(!1)}catch(e){console.error("Error creating task:",e)}finally{v(!1)}},q=async e=>{if(b===e)return;let t=(0,o.getToken)(),r="";if(t)try{let e=JSON.parse(atob(t.split(".")[1]));if(!(r=e.userId||e.sub||""))return void console.error("User ID not found in token payload")}catch(e){console.error("Error parsing token:",e);return}p(e);try{let t=await l(r,e,{title:S,description:C}),o=I(t);x(t=>t.map(t=>t.id===e?o:t)),u&&u(o),E(null)}catch(e){console.error("Error updating task:",e)}finally{p(null),E(null)}},P=()=>{E(null)};return 0===m.length?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"text-center py-12 bg-white border border-brown-accent rounded-xl shadow-sm hover:shadow-lg transition-shadow duration-300",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-black mb-2",children:"No tasks yet"}),(0,t.jsx)("p",{className:"text-black",children:"Add your first task to get started!"})]}),g&&(0,t.jsx)("div",{className:"p-4 bg-white border border-brown-accent rounded-xl shadow-sm hover:shadow-lg transition-shadow duration-300",children:(0,t.jsxs)("form",{onSubmit:$,children:[(0,t.jsx)("div",{className:"mb-3",children:(0,t.jsx)("input",{type:"text",value:w,onChange:e=>k(e.target.value),placeholder:"Task title",className:"w-full px-3 py-2 border border-brown-border rounded-lg focus:outline-none focus:ring-2 focus:ring-brown-accent",required:!0})}),(0,t.jsx)("div",{className:"mb-3",children:(0,t.jsx)("textarea",{value:y,onChange:e=>N(e.target.value),placeholder:"Task description (optional)",className:"w-full px-3 py-2 border border-brown-border rounded-lg focus:outline-none focus:ring-2 focus:ring-brown-accent",rows:2})}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("button",{type:"submit",disabled:j,className:"btn-brown-gradient px-8 py-4 text-lg rounded-lg disabled:opacity-50",children:j?"Creating...":"Add Task"}),(0,t.jsx)("button",{type:"button",onClick:()=>f(!1),className:"px-4 py-2 bg-brown-light text-black rounded-lg hover:bg-[#d4c1c6]",children:"Cancel"})]})]})})]}):(0,t.jsxs)("div",{className:"space-y-4",children:[g&&(0,t.jsx)("div",{className:"p-4 bg-white border border-brown-accent rounded-xl shadow-sm hover:shadow-lg transition-shadow duration-300",children:(0,t.jsxs)("form",{onSubmit:$,children:[(0,t.jsx)("div",{className:"mb-3",children:(0,t.jsx)("input",{type:"text",value:w,onChange:e=>k(e.target.value),placeholder:"Task title",className:"w-full px-3 py-2 border border-brown-border rounded-lg focus:outline-none focus:ring-2 focus:ring-brown-accent",required:!0})}),(0,t.jsx)("div",{className:"mb-3",children:(0,t.jsx)("textarea",{value:y,onChange:e=>N(e.target.value),placeholder:"Task description (optional)",className:"w-full px-3 py-2 border border-brown-border rounded-lg focus:outline-none focus:ring-2 focus:ring-brown-accent",rows:2})}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("button",{type:"submit",disabled:j,className:"btn-brown-gradient px-8 py-4 text-lg rounded-lg disabled:opacity-50",children:j?"Creating...":"Add Task"}),(0,t.jsx)("button",{type:"button",onClick:()=>f(!1),className:"px-4 py-2 bg-brown-light text-black rounded-lg hover:bg-[#d4c1c6]",children:"Cancel"})]})]})}),m.map(e=>(0,t.jsx)("div",{className:"p-4 bg-white border border-brown-accent rounded-xl shadow-sm hover:shadow-lg transition-shadow duration-300",children:T===e.id?(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("input",{type:"text",value:S,onChange:e=>_(e.target.value),className:"w-full px-3 py-2 border border-brown-border rounded-lg focus:outline-none focus:ring-2 focus:ring-brown-accent",required:!0}),(0,t.jsx)("textarea",{value:C,onChange:e=>A(e.target.value),className:"w-full px-3 py-2 border border-brown-border rounded-lg focus:outline-none focus:ring-2 focus:ring-brown-accent",rows:2}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("button",{onClick:()=>q(e.id),className:"px-4 py-2 bg-brown-accent text-white rounded-lg hover:bg-[#8b5a6b]",children:"Save"}),(0,t.jsx)("button",{onClick:P,className:"px-4 py-2 bg-brown-light text-black rounded-lg hover:bg-[#d4c1c6]",children:"Cancel"})]})]}):(0,t.jsxs)("div",{className:"flex items-start",children:[(0,t.jsx)("input",{type:"checkbox",checked:e.completed,onChange:()=>D(e.id,e.completed),disabled:b===e.id,className:"mt-1 mr-3 h-5 w-5 rounded border-brown-border text-brown-accent focus:ring-brown-accent"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h3",{className:`text-lg font-medium ${e.completed?"line-through text-brown-accent":"text-black"}`,children:e.title}),e.description&&(0,t.jsx)("p",{className:`mt-1 ${e.completed?"line-through text-brown-accent":"text-black"}`,children:e.description}),(0,t.jsxs)("div",{className:"mt-2 flex space-x-3",children:[(0,t.jsx)("button",{onClick:()=>{E(e.id),_(e.title),A(e.description||"")},className:"text-sm text-brown-accent hover:underline",children:"Edit"}),(0,t.jsx)("button",{onClick:()=>O(e.id),className:"text-sm text-brown-accent hover:underline",children:"Delete"})]})]})]})},e.id))]})};var m=e.i(932);let x=e=>{let r,o,s,a,n,l,c,i,d,u,h,x=(0,m.c)(21),{user:b,taskCount:p,pendingTaskCount:g,completedTaskCount:f}=e;x[0]===Symbol.for("react.memo_cache_sentinel")?(r=(0,t.jsx)("h3",{className:"text-sm font-semibold text-black mb-1",children:"Name"}),x[0]=r):r=x[0];let w=b?.name||"User";x[1]!==w?(o=(0,t.jsxs)("div",{className:"w-[240px] h-[100px] flex flex-col items-center justify-center\n                        bg-brown-light border border-brown-accent rounded-xl shadow-sm\n                        hover:shadow-lg transition-shadow duration-300",children:[r,(0,t.jsx)("p",{className:"text-sm font-medium text-brown-accent",children:w})]}),x[1]=w,x[2]=o):o=x[2],x[3]===Symbol.for("react.memo_cache_sentinel")?(s=(0,t.jsx)("h3",{className:"text-sm font-semibold text-black mb-1",children:"Email"}),x[3]=s):s=x[3];let k=b?.email||"user@example.com";return x[4]!==k?(a=(0,t.jsxs)("div",{className:"w-[240px] h-[100px] flex flex-col items-center justify-center\n                        bg-brown-light border border-brown-accent rounded-xl shadow-sm\n                        hover:shadow-lg transition-shadow duration-300",children:[s,(0,t.jsx)("p",{className:"text-sm font-medium text-brown-accent",children:k})]}),x[4]=k,x[5]=a):a=x[5],x[6]===Symbol.for("react.memo_cache_sentinel")?(n=(0,t.jsx)("h3",{className:"text-sm font-semibold text-black mb-1",children:"Total Tasks"}),x[6]=n):n=x[6],x[7]!==p?(l=(0,t.jsxs)("div",{className:"w-[240px] h-[100px] flex flex-col items-center justify-center\n                        bg-brown-light border border-brown-accent rounded-xl shadow-sm\n                        hover:shadow-lg transition-shadow duration-300",children:[n,(0,t.jsx)("p",{className:"text-sm font-medium text-brown-accent",children:p})]}),x[7]=p,x[8]=l):l=x[8],x[9]===Symbol.for("react.memo_cache_sentinel")?(c=(0,t.jsx)("h3",{className:"text-sm font-semibold text-black mb-1",children:"Pending Tasks"}),x[9]=c):c=x[9],x[10]!==g?(i=(0,t.jsxs)("div",{className:"w-[240px] h-[100px] flex flex-col items-center justify-center\n                        bg-brown-light border border-brown-accent rounded-xl shadow-sm\n                        hover:shadow-lg transition-shadow duration-300",children:[c,(0,t.jsx)("p",{className:"text-sm font-medium text-brown-accent",children:g})]}),x[10]=g,x[11]=i):i=x[11],x[12]===Symbol.for("react.memo_cache_sentinel")?(d=(0,t.jsx)("h3",{className:"text-sm font-semibold text-black mb-1",children:"Completed Tasks"}),x[12]=d):d=x[12],x[13]!==f?(u=(0,t.jsxs)("div",{className:"w-[240px] h-[100px] flex flex-col items-center justify-center\n                        bg-brown-light border border-brown-accent rounded-xl shadow-sm\n                        hover:shadow-lg transition-shadow duration-300",children:[d,(0,t.jsx)("p",{className:"text-sm font-medium text-brown-accent",children:f})]}),x[13]=f,x[14]=u):u=x[14],x[15]!==i||x[16]!==u||x[17]!==o||x[18]!==a||x[19]!==l?(h=(0,t.jsx)("div",{className:"w-full flex",children:(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 ml-auto",children:[" ",o,a,l,i,u]})}),x[15]=i,x[16]=u,x[17]=o,x[18]=a,x[19]=l,x[20]=h):h=x[20],h};var b=e.i(43174);let p=e=>({id:e.id.toString(),title:e.title,description:e.description,completed:e.completed,userId:e.user_id,createdAt:e.created_at,updatedAt:e.updated_at});e.s(["default",0,()=>{let[e,s]=(0,r.useState)(null),[n,l]=(0,r.useState)([]),[c,i]=(0,r.useState)(0),[m,g]=(0,r.useState)(0),[f,w]=(0,r.useState)(!0),[k,y]=(0,r.useState)(""),[N,j]=(0,r.useState)(!1);return((0,r.useEffect)(()=>{if(!(0,o.isAuthenticated)()){window.location.href="/login";return}(async()=>{try{let e=await (0,b.getCurrentUser)();s(e);let t=(await a(e.id)).map(p);l(t);let r=await d(e.id);i(r.pending);let o=await u(e.id);g(o.completed)}catch(e){y(e.message||"Error fetching user data or tasks"),console.error("Error fetching user data or tasks:",e)}finally{w(!1)}})()},[]),f)?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brown-accent mx-auto"}),(0,t.jsx)("p",{className:"mt-4 text-black",children:"Loading dashboard..."})]})}):(0,t.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsxs)("h1",{className:"text-3xl md:text-4xl font-serif font-bold text-left mb-4 text-brown-accent",children:["Welcome to Todo App, ",e?.name||"User"]}),(0,t.jsx)("p",{className:"text-lg text-black opacity-80",children:"Organize your tasks, stay focused, and make every day productive."})]}),k&&(0,t.jsx)("div",{className:"mb-6 p-4 bg-brown-light text-brown-accent rounded-lg border border-brown-accent",children:k}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-8",children:[" ",(0,t.jsx)(x,{user:e,taskCount:n.length,pendingTaskCount:c,completedTaskCount:m})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:(0,t.jsxs)("div",{className:"lg:col-span-3",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-semibold text-black",children:"Your Tasks"}),(0,t.jsx)("button",{onClick:()=>{j(!0)},className:"btn-brown-gradient px-8 py-4 text-lg rounded-lg",children:"Add Task"})]}),(0,t.jsx)(h,{tasks:n,forceShowAddForm:N,onAddTaskClick:()=>j(!1),onTaskAdded:e=>{l(t=>[e,...t]),e.completed?g(e=>e+1):i(e=>e+1)},onTaskUpdated:e=>{l(t=>t.map(t=>t.id===e.id?e:t));let t=n.find(t=>t.id===e.id);t&&t.completed!==e.completed&&(t.completed&&!e.completed?(g(e=>e-1),i(e=>e+1)):!t.completed&&e.completed&&(i(e=>e-1),g(e=>e+1)))},onTaskDeleted:e=>{let t=n.find(t=>t.id===e);l(t=>t.filter(t=>t.id!==e)),t&&(t.completed?g(e=>Math.max(0,e-1)):i(e=>Math.max(0,e-1)))}})]})})]})}],30257)}]);